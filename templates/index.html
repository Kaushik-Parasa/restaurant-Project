<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mekkesi po</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #a8d5e3 0%, #ff78ac 100%);
      min-height: 100vh;
    }

    .restaurant-card {
      transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
      cursor: pointer;
    }

    .restaurant-card:hover {
      transform: translateY(-5px);
      background-color: #ddd6d6;
    }

    nav a:hover {
      color: #1d4ed8;
    }

    .hidden-section {
      display: none;
    }
  </style>
</head>
<body class="pt-24 px-4 flex flex-col items-center">

  <!-- Navbar -->
  <nav class="fixed top-4 left-6 flex gap-6 text-white font-bold text-lg z-50">
    <a href="#" onclick="showSection('home')">Home</a>
    <a href="#" onclick="showSection('about')">About</a>
    <a href="#" onclick="showSection('contact')">Contact</a>
  </nav>

  <!-- Home Section -->
  <div id="home" class="w-full max-w-4xl hidden-section">
    <h1 class="text-4xl font-bold text-gray-800 text-center mb-8">MEKKESI PO</h1>
    <div class="flex justify-center mb-10">
      <div class="w-full max-w-lg flex gap-2">
        <input
          type="text"
          id="location-input"
          placeholder="Enter location to find your luv"
          class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700"
        >
        <button
          onclick="fetchRestaurants(1)"
          class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700"
        >
          Search
        </button>
      </div>
    </div>

    <div id="restaurant-list" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

    <div class="flex justify-center gap-4 mt-6">
      <button id="prev-btn" class="bg-gray-700 text-white px-4 py-2 rounded" onclick="changePage(-1)">Previous</button>
      <button id="next-btn" class="bg-gray-700 text-white px-4 py-2 rounded" onclick="changePage(1)">Next</button>
    </div>

    <div id="error-message" class="text-red-500 text-center mt-4"></div>
  </div>

  <!-- About Section -->
  <div id="about" class="hidden-section bg-white mt-24 p-8 rounded-lg shadow-lg max-w-2xl">
    <h1 class="text-3xl font-bold mb-4 text-gray-800">About Us</h1>
    <p class="text-gray-700">
      Restaurant Finder helps you explore top-rated restaurants in your area.
      We are dedicated find your crush(food) and have it with your crush if available or have food to digest that you are single.
      but dont forget to pay the bill even if you had crush or single. When it comes to bill you are forever single.
    </p>
  </div>

  <!-- Contact Section -->
  <div id="contact" class="hidden-section bg-white mt-24 p-8 rounded-lg shadow-lg max-w-2xl">
    <h1 class="text-3xl font-bold mb-4 text-gray-800">Contact Us</h1>
    <p class="text-gray-700 mb-2">
      For support , email us. For food related issues do not contact us thank you! :
    </p>
    <a href="mailto:naamailneekuendukurapokodi@foodluv.com" class="text-blue-600 underline">naamailneekuendukurapokodi@foodluv.com</a>
  </div>
  <footer style="text-align: center; padding: 1em 0; font-size: 0.9rem; color: #888;">
    &copy; 2025 Chinmay Kaushik. All rights reserved.
</footer>

  <!-- JavaScript -->
  <script>
    let currentPage = 1;
    let totalPages = 1;
    let currentRestaurants = [];

    function showSection(id) {
      document.querySelectorAll('.hidden-section').forEach(div => div.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    // Default show Home
    showSection('home');

    async function fetchRestaurants(page = 1) {
      const location = document.getElementById("location-input").value.trim();
      const restaurantListDiv = document.getElementById("restaurant-list");
      const errorDiv = document.getElementById("error-message");
      restaurantListDiv.innerHTML = "";
      errorDiv.innerHTML = "";

      if (!location) {
        errorDiv.innerHTML = "Please enter a location.";
        return;
      }

      try {
        const response = await fetch(`https://restaurenthefoodluv-b2e5b9ajgrhpcdc0.southindia-01.azurewebsites.net/restaurants/${encodeURIComponent(location)}`);
        if (!response.ok) throw new Error(`Failed to fetch: ${response.status}`);
        const data = await response.json();
        currentRestaurants = data || [];
        totalPages = Math.min(Math.ceil(currentRestaurants.length / 4), 5);
        currentPage = page;
        renderPage();
      } catch (error) {
        errorDiv.innerHTML = `Error: ${error.message}`;
        console.error("Fetch error:", error);
      }
    }

    function renderPage() {
      const restaurantListDiv = document.getElementById("restaurant-list");
      restaurantListDiv.innerHTML = "";

      const start = (currentPage - 1) * 4;
      const end = start + 4;
      const pageData = currentRestaurants.slice(start, end);

      if (pageData.length === 0) {
        restaurantListDiv.innerHTML = '<p class="text-gray-500 text-center col-span-full">No restaurants found.</p>';
        return;
      }

      pageData.forEach(restaurant => {
        const card = document.createElement("div");
        card.className = "restaurant-card bg-white p-5 rounded-lg shadow-md";
        card.innerHTML = `
          <h3 class="text-xl font-semibold text-gray-800">${restaurant.name}</h3>
          <p class="text-gray-600">Rating: <span class="font-medium">${restaurant.rating || "N/A"}</span></p>
          <p class="text-gray-600">Price: <span class="font-medium">${restaurant.price_level ? "$".repeat(restaurant.price_level) : "N/A"}</span></p>
          <p class="text-gray-600">Address: <span class="font-medium">${restaurant.address || "N/A"}</span></p>
        `;
        card.addEventListener("click", () => {
          const address = restaurant.address || `${restaurant.name}`;
          const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`;
          window.open(mapsUrl, "_blank");
        });
        restaurantListDiv.appendChild(card);
      });

      document.getElementById("prev-btn").disabled = currentPage === 1;
      document.getElementById("next-btn").disabled = currentPage === totalPages;
    }

    function changePage(direction) {
      const newPage = currentPage + direction;
      if (newPage >= 1 && newPage <= totalPages) {
        currentPage = newPage;
        renderPage();
      }
    }

    document.getElementById("location-input").addEventListener("keypress", function (event) {
      if (event.key === "Enter") fetchRestaurants(1);
    });
  </script>
</body>
</html>
