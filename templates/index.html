<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DINE & SEEK</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #1e1e1e;
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .restaurant-card {
      background-color: #2c2c2c;
      color: #e5e7eb;
      transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
      cursor: pointer;
    }

    .restaurant-card:hover {
      transform: translateY(-5px);
      background-color: #eeeeee;
    }

    .hidden-section {
      display: none;
    }
    input, .bg-white {
      background-color: #2a2a2a;
      color: #e5e7eb;
      border-color: #444;
    }

    input::placeholder {
      color: #aaa;
    }

    main {
      flex: 1;
    }

    .sidebar-collapsed {
      transform: translateX(-100%);
    }

    .sidebar-expanded {
      transform: translateX(0);
    }

    main {
      flex: 1;
    }
  </style>
</head>
<body class="pt-20 px-4 flex flex-col items-center relative">

  <!-- Sidebar -->
  <div id="sidebar" class="fixed top-0 left-0 w-64 h-full bg-[#1e1e1e] text-white flex flex-col items-start px-6 py-10 z-50 transform transition-transform duration-300 -translate-x-full">
    <button onclick="toggleSidebar()" class="mb-6 self-end text-white text-xl">✕</button>
    <a href="#" class="mb-4 text-lg font-bold hover:text-blue-400" onclick="navigateTo('home')">Home</a>
    <a href="#" class="mb-4 text-lg font-bold hover:text-blue-400" onclick="navigateTo('about')">About</a>
    <a href="#" class="text-lg font-bold hover:text-blue-400" onclick="navigateTo('contact')">Contact</a>
  </div>

  <!-- Sidebar Toggle -->
  <button onclick="toggleSidebar()" class="fixed top-4 left-4 z-50 text-white bg-gray-900 px-3 py-2 rounded-md hover:bg-gray-700">
    ☰
  </button>

  <main class="w-full flex flex-col items-center">

    <!-- Home Section -->
    <div id="home" class="w-full max-w-4xl hidden-section">
      <h1 class="text-4xl font-bold text-white text-center mb-8">DINE & SEEK</h1>

      <!-- Search Bar -->
      <div class="flex justify-center mb-10">
        <div class="w-full max-w-xl relative">
          <input
            type="text"
            id="location-input"
            placeholder="Enter location to find your luv"
            class="w-full p-3 pl-4 pr-12 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 text-white-700"
          />
          <button
            onclick="fetchRestaurants(1)"
            class="absolute right-2 top-2.5 text-blue-600 hover:text-blue-800"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
              viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"/>
            </svg>
          </button>
        </div>
      </div>

      <div id="restaurant-list" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

      <div class="flex justify-center gap-4 mt-6">
        <button id="prev-btn" class="bg-gray-700 text-white px-4 py-2 rounded" onclick="changePage(-1)">Previous</button>
        <button id="next-btn" class="bg-gray-700 text-white px-4 py-2 rounded" onclick="changePage(1)">Next</button>
      </div>

      <div id="error-message" class="text-red-500 text-center mt-4"></div>
    </div>

    <!-- About Section -->
    <div id="about" class="hidden-section bg-gray-800 mt-24 p-8 rounded-lg shadow-lg max-w-2xl text-white">
      <h1 class="text-3xl font-bold mb-4">About Us</h1>
      <p>
        Restaurant Finder helps you explore top-rated restaurants in your area.
        We are dedicated find your crush (food) and have it with your crush if available or have food to digest that you are single.
        But don’t forget to pay the bill whether you are with your crush or single. When it comes to the bill, you are forever single.
      </p>
    </div>

    <!-- Contact Section -->
    <div id="contact" class="hidden-section bg-gray-800 mt-24 p-8 rounded-lg shadow-lg max-w-2xl text-white">
      <h1 class="text-3xl font-bold mb-4">About Us</h1>
      <p>
        For support, email us. For food-related issues do not contact us, thank you! :
      </p>
      <a href="mailto:naamailneekuendukurapokodi@foodluv.com" class="text-blue-600 underline">naamailneekuendukurapokodi@foodluv.com</a>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white text-center py-4 text-sm w-full mt-8">
    <span class="flex justify-center items-center gap-1">
      <span>&copy;</span>
      <span>2025 Chinmay Kaushik. All rights reserved.</span>
    </span>
  </footer>

  <!-- Scripts -->
  <script>
    let currentPage = 1;
    let totalPages = 1;
    let currentRestaurants = [];

    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      sidebar.classList.toggle("-translate-x-full");
    }

    function navigateTo(id) {
      showSection(id);
      toggleSidebar(); // Close sidebar after selecting a section
    }

    function showSection(id) {
      document.querySelectorAll('.hidden-section').forEach(div => div.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    // Default section
    showSection('home');

    async function fetchRestaurants(page = 1) {
      const location = document.getElementById("location-input").value.trim();
      const restaurantListDiv = document.getElementById("restaurant-list");
      const errorDiv = document.getElementById("error-message");
      restaurantListDiv.innerHTML = "";
      errorDiv.innerHTML = "";

      if (!location) {
        errorDiv.innerHTML = "Please enter a location.";
        return;
      }

      try {
        const response = await fetch(`https://restaurenthefoodluv-b2e5b9ajgrhpcdc0.southindia-01.azurewebsites.net/restaurants/${encodeURIComponent(location)}`);
        if (!response.ok) throw new Error(`Failed to fetch: ${response.status}`);
        const data = await response.json();
        currentRestaurants = data || [];
        totalPages = Math.min(Math.ceil(currentRestaurants.length / 4), 5);
        currentPage = page;
        renderPage();
      } catch (error) {
        errorDiv.innerHTML = `Error: ${error.message}`;
        console.error("Fetch error:", error);
      }
    }

    function renderPage() {
      const restaurantListDiv = document.getElementById("restaurant-list");
      restaurantListDiv.innerHTML = "";

      const start = (currentPage - 1) * 4;
      const end = start + 4;
      const pageData = currentRestaurants.slice(start, end);

      if (pageData.length === 0) {
        restaurantListDiv.innerHTML = '<p class="text-gray-500 text-center col-span-full">No restaurants found.</p>';
        return;
      }

      pageData.forEach(restaurant => {
        const card = document.createElement("div");
        card.className = "restaurant-card bg-white p-5 rounded-lg shadow-md";
        card.innerHTML = `
          <h3 class="text-xl font-semibold text-gray-800">${restaurant.name}</h3>
          <p class="text-gray-600">Rating: <span class="font-medium">${restaurant.rating || "N/A"}</span></p>
          <p class="text-gray-600">Price: <span class="font-medium">${restaurant.price_level ? "$".repeat(restaurant.price_level) : "N/A"}</span></p>
          <p class="text-gray-600">Address: <span class="font-medium">${restaurant.address || "N/A"}</span></p>
        `;
        card.addEventListener("click", () => {
          const address = restaurant.address || `${restaurant.name}`;
          const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`;
          window.open(mapsUrl, "_blank");
        });
        restaurantListDiv.appendChild(card);
      });

      document.getElementById("prev-btn").disabled = currentPage === 1;
      document.getElementById("next-btn").disabled = currentPage === totalPages;
    }

    function changePage(direction) {
      const newPage = currentPage + direction;
      if (newPage >= 1 && newPage <= totalPages) {
        currentPage = newPage;
        renderPage();
      }
    }

    document.getElementById("location-input").addEventListener("keypress", function (event) {
      if (event.key === "Enter") fetchRestaurants(1);
    });
  </script>
</body>
</html>
